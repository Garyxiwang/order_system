# 订单系统生产环境配置示例
# 复制此文件为 .env 并填入实际值

# ================================
# 基础配置
# ================================
ENVIRONMENT=production
VERSION=latest
NODE_ENV=production

# ================================
# 域名和 URL 配置
# ================================
DOMAIN_NAME=yourdomain.com
API_URL=https://yourdomain.com
FRONTEND_URL=https://yourdomain.com

# ================================
# 数据库配置
# ================================
# PostgreSQL 数据库连接
DATABASE_URL=postgresql://admin:your-db-password@database:5432/order_system
DB_HOST=database
DB_PORT=5432
DB_NAME=order_system
DB_USER=admin
DB_PASSWORD=your-strong-database-password

# 数据库连接池配置
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=30
DB_POOL_TIMEOUT=30

# ================================
# Redis 缓存配置
# ================================
REDIS_URL=redis://:your-redis-password@redis:6379/0
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=your-redis-password
REDIS_DB=0

# Redis 连接池配置
REDIS_POOL_SIZE=10
REDIS_POOL_TIMEOUT=5

# ================================
# 应用安全配置
# ================================
# 应用密钥（用于加密会话等）
SECRET_KEY=your-very-long-and-random-secret-key-here

# JWT 配置
JWT_SECRET=your-jwt-secret-key-here
JWT_ALGORITHM=HS256
JWT_EXPIRE_MINUTES=1440

# 密码加密
BCRYPT_ROUNDS=12

# ================================
# AWS 服务配置（如果使用 AWS）
# ================================
AWS_REGION=us-west-2
AWS_ACCESS_KEY_ID=your-aws-access-key
AWS_SECRET_ACCESS_KEY=your-aws-secret-key

# S3 存储配置
S3_BUCKET=your-s3-bucket-name
S3_REGION=us-west-2
S3_ENDPOINT_URL=https://s3.us-west-2.amazonaws.com

# CloudFront CDN
CLOUDFRONT_DOMAIN=your-cloudfront-domain.cloudfront.net

# ================================
# 邮件服务配置
# ================================
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-app-password
SMTP_USE_TLS=true
SMTP_USE_SSL=false

# 邮件发送配置
FROM_EMAIL=noreply@yourdomain.com
FROM_NAME=订单系统

# ================================
# 支付服务配置
# ================================
# 支付宝配置
ALIPAY_APP_ID=your-alipay-app-id
ALIPAY_PRIVATE_KEY=your-alipay-private-key
ALIPAY_PUBLIC_KEY=your-alipay-public-key
ALIPAY_GATEWAY=https://openapi.alipay.com/gateway.do

# 微信支付配置
WECHAT_APP_ID=your-wechat-app-id
WECHAT_MCH_ID=your-wechat-mch-id
WECHAT_API_KEY=your-wechat-api-key
WECHAT_CERT_PATH=/app/certs/wechat_cert.pem
WECHAT_KEY_PATH=/app/certs/wechat_key.pem

# ================================
# 第三方服务配置
# ================================
# 短信服务
SMS_PROVIDER=aliyun
SMS_ACCESS_KEY=your-sms-access-key
SMS_SECRET_KEY=your-sms-secret-key
SMS_SIGN_NAME=订单系统
SMS_TEMPLATE_CODE=SMS_123456789

# 对象存储（如果不使用 AWS S3）
OSS_ENDPOINT=https://oss-cn-hangzhou.aliyuncs.com
OSS_ACCESS_KEY_ID=your-oss-access-key
OSS_ACCESS_KEY_SECRET=your-oss-secret-key
OSS_BUCKET=your-oss-bucket

# ================================
# 监控和日志配置
# ================================
# 日志级别
LOG_LEVEL=INFO
LOG_FORMAT=json

# Sentry 错误监控
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
SENTRY_ENVIRONMENT=production

# 监控服务
GRAFANA_PASSWORD=your-grafana-password
PROMETHEUS_RETENTION=15d

# ================================
# 应用特定配置
# ================================
# 文件上传配置
MAX_FILE_SIZE=10485760  # 10MB
ALLOWED_FILE_TYPES=jpg,jpeg,png,gif,pdf,doc,docx
UPLOAD_PATH=/app/uploads

# 分页配置
DEFAULT_PAGE_SIZE=20
MAX_PAGE_SIZE=100

# 缓存配置
CACHE_TTL=3600  # 1小时
SESSION_TTL=86400  # 24小时

# API 限流配置
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_BURST=10

# ================================
# 前端配置
# ================================
NEXT_PUBLIC_API_URL=https://yourdomain.com
NEXT_PUBLIC_APP_NAME=订单管理系统
NEXT_PUBLIC_APP_VERSION=1.0.0
NEXT_TELEMETRY_DISABLED=1

# 前端构建配置
NODE_OPTIONS=--max-old-space-size=4096

# ================================
# 数据库备份配置
# ================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *  # 每天凌晨2点
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=your-backup-bucket

# ================================
# SSL/TLS 配置
# ================================
SSL_CERT_PATH=/etc/nginx/ssl/fullchain.pem
SSL_KEY_PATH=/etc/nginx/ssl/privkey.pem
SSL_PROTOCOLS=TLSv1.2 TLSv1.3

# ================================
# 性能优化配置
# ================================
# 数据库连接配置
DB_ECHO=false
DB_POOL_PRE_PING=true
DB_POOL_RECYCLE=3600

# Redis 配置
REDIS_DECODE_RESPONSES=true
REDIS_SOCKET_KEEPALIVE=true
REDIS_SOCKET_KEEPALIVE_OPTIONS=1,3,5

# 应用工作进程配置
WORKERS=4
WORKER_CONNECTIONS=1000
WORKER_CLASS=uvicorn.workers.UvicornWorker

# ================================
# 开发和调试配置（生产环境应设为 false）
# ================================
DEBUG=false
TESTING=false
PROFILING=false

# API 文档
DOCS_ENABLED=false
REDOC_ENABLED=false

# ================================
# 安全配置
# ================================
# CORS 配置
CORS_ORIGINS=https://yourdomain.com,https://www.yourdomain.com
CORS_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_HEADERS=*

# 安全头配置
SECURITY_HEADERS_ENABLED=true
HSTS_MAX_AGE=31536000
CSP_ENABLED=true

# ================================
# 健康检查配置
# ================================
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PATH=/health
HEALTH_CHECK_TIMEOUT=30

# ================================
# 注意事项
# ================================
# 1. 请将此文件重命名为 .env
# 2. 填入实际的配置值，特别是密码和密钥
# 3. 不要将包含敏感信息的 .env 文件提交到版本控制系统
# 4. 生产环境建议使用环境变量或密钥管理服务
# 5. 定期轮换密钥和密码
# 6. 使用强密码和复杂的密钥